<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø¯ÙˆÙ†Ø© Zahran Law</title>
  <meta name="description" content="Ù…Ø¯ÙˆÙ†Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø¹Ø§Ù„Ù…ÙŠØ© ØªÙ‚Ø¯Ù… Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ£Ø®Ø¨Ø§Ø± Ø¹Ù† Ø§Ù„ØªØ´Ø±ÙŠØ¹Ø§Øª ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… ÙˆØ§Ù„ÙƒØªØ¨ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©.">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #1a365d;
      --accent: #d4af37;
      --light: #f9fafb;
      --dark: #2d3748;
      --gray: #718096;
    }
    body { font-family: 'Tahoma', sans-serif; background: var(--light); margin: 0; padding: 0; color: var(--dark); }
    header { background: linear-gradient(135deg, var(--primary), #2a4365); color: #fff; padding: 20px 15px; text-align: center; position: sticky; top: 0; z-index: 100; }
    header h1 { margin: 10px 0 5px; font-size: 2rem; }
    header p { margin-top: 0; opacity: 0.9; font-size: 1rem; }
    nav { margin-top: 10px; }
    nav a { color: #fff; margin: 0 10px; text-decoration: none; font-weight: bold; transition: 0.3s; }
    nav a:hover { color: var(--accent); }
    .container { max-width: 1100px; margin: 20px auto; padding: 0 15px; }
    .controls { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 20px; }
    .controls input, .controls select { padding: 10px; border: 1px solid #ccc; border-radius: 6px; }
    .controls input { width: 70%; max-width: 350px; }
    .posts { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
    .post { background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,.08); display: flex; flex-direction: column; transition: transform 0.2s; }
    .post:hover { transform: translateY(-5px); }
    .post img { max-width: 100%; border-radius: 8px; margin-bottom: 12px; }
    .post h2 { margin: 0 0 10px; color: var(--primary); font-size: 1.3rem; }
    .post .meta { font-size: 0.85rem; color: var(--gray); margin-bottom: 12px; }
    .tags { margin-top: 10px; }
    .tag { display: inline-block; background: var(--accent); color: #000; padding: 3px 8px; border-radius: 5px; font-size: 0.8rem; margin: 3px; cursor: pointer; }
    .read-more { margin-top: 15px; align-self: flex-start; background: var(--primary); color: #fff; padding: 8px 14px; border-radius: 6px; text-decoration: none; font-size: 0.9rem; transition: 0.3s; }
    .read-more:hover { background: var(--accent); color: #000; }
    .note { margin-top: 25px; padding: 15px; background: #fff; border-left: 4px solid var(--primary); border-radius: 8px; font-size: 0.9rem; color: var(--gray); }
    .results-count { text-align: center; margin-bottom: 15px; color: var(--gray); font-size: 0.9rem; }
    .pagination { display: flex; justify-content: center; margin: 25px 0; gap: 8px; flex-wrap: wrap; }
    .pagination button { padding: 8px 12px; border: none; border-radius: 6px; cursor: pointer; background: var(--primary); color: #fff; font-size: 0.9rem; transition: 0.3s; }
    .pagination button.disabled { background: #ccc; cursor: default; }
    .pagination button.active { background: var(--accent); color: #000; }
    footer { text-align: center; padding: 20px; margin-top: 30px; font-size: 0.9rem; color: var(--gray); background: #fff; border-top: 1px solid #eee; }

    /* Modal */
    .modal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); }
    .modal-content { background: #fff; margin: 5% auto; padding: 20px; border-radius: 12px; max-width: 800px; position: relative; animation: fadeIn 0.3s ease-in-out; }
    .close { position: absolute; top: 15px; left: 15px; font-size: 1.5rem; cursor: pointer; color: var(--gray); }
    .modal-content h2 { margin-top: 0; color: var(--primary); }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-20px);} to { opacity: 1; transform: translateY(0);} }

    @media (max-width: 600px) {
      header h1 { font-size: 1.6rem; }
      .post h2 { font-size: 1.1rem; }
    }
  </style>
</head>
<body>
  <header>
    <h1>ğŸ“ Ù…Ø¯ÙˆÙ†Ø© Zahran Law</h1>
    <p>Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØªØ­Ù„ÙŠÙ„Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø¹Ø§Ù„Ù…ÙŠØ© Ø¨Ù„Ù…Ø³Ø© Ù…Ù‡Ù†ÙŠØ©</p>
    <nav>
      <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="law.html">Ø§Ù„ØªØ´Ø±ÙŠØ¹Ø§Øª</a>
      <a href="blog.html">Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©</a>
      <a href="contact.html">Ø§ØªØµÙ„ Ø¨Ù†Ø§</a>
    </nav>
  </header>

  <main class="container">
    <div class="controls">
      <input id="searchInput" type="text" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª...">
      <select id="categoryFilter">
        <option value="">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
        <option value="ØªØ´Ø±ÙŠØ¹Ø§Øª">ØªØ´Ø±ÙŠØ¹Ø§Øª</option>
        <option value="Ø£Ø­ÙƒØ§Ù…">Ø£Ø­ÙƒØ§Ù…</option>
        <option value="ÙƒØªØ¨">ÙƒØªØ¨</option>
        <option value="Ù…Ù‚Ø§Ù„Ø§Øª Ø¹Ø§Ù…Ø©">Ù…Ù‚Ø§Ù„Ø§Øª Ø¹Ø§Ù…Ø©</option>
        <option value="Ø£Ø®Ø¨Ø§Ø±">Ø£Ø®Ø¨Ø§Ø±</option>
      </select>
    </div>
    <div id="resultsCount" class="results-count"></div>
    <div id="posts" class="posts"></div>
    <div class="pagination" id="pagination"></div>
    <div class="note"><i class="fas fa-lightbulb"></i> ØªØ§Ø¨Ø¹ Ù…Ø¯ÙˆÙ†ØªÙ†Ø§ Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù„ØªÙƒÙˆÙ† Ø¹Ù„Ù‰ Ø§Ø·Ù„Ø§Ø¹ Ø¨Ø¢Ø®Ø± Ø§Ù„Ù…Ø³ØªØ¬Ø¯Ø§Øª Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø¹Ø§Ù„Ù…ÙŠÙ‹Ø§ ÙˆØ¹Ø±Ø¨ÙŠÙ‹Ø§.</div>
  </main>

  <footer>
    Â© 2025 ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€” Zahran Law
  </footer>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2 id="modalTitle"></h2>
      <div id="modalMeta" class="meta"></div>
      <div id="modalContent"></div>
    </div>
  </div>

  <script>
    const SHEET_ID = "1tQ6NpGMHojxf5XjFyoAkeN0Uivn_FE42vGPXKFLqj-Y";
    const SHEET_NAME = "legal";
    const SHEET_URL = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;

    let allPosts = [];
    let currentPage = 1;
    const postsPerPage = 6;

    async function loadPosts() {
      const postsEl = document.getElementById('posts');
      postsEl.innerHTML = '<div style="text-align:center;padding:20px;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
      try {
        const res = await fetch(SHEET_URL);
        if(!res.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        allPosts = await res.json();
        renderPosts();
      } catch (e) {
        postsEl.innerHTML = '<div style="color:red;text-align:center;">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</div>';
      }
    }

    function renderPosts() {
      const searchQuery = (document.getElementById('searchInput').value || '').toLowerCase();
      const category = document.getElementById('categoryFilter').value;

      let filtered = allPosts.filter(d => {
        const matchesSearch = (d.title || '').toLowerCase().includes(searchQuery) ||
                              (d.summary || '').toLowerCase().includes(searchQuery) ||
                              (d.content || '').toLowerCase().includes(searchQuery);
        const matchesCategory = !category || (d.category || '').includes(category);
        return matchesSearch && matchesCategory;
      });

      const postsEl = document.getElementById('posts');
      const resultsCountEl = document.getElementById('resultsCount');
      postsEl.innerHTML = '';

      resultsCountEl.innerText = `Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ${filtered.length}`;

      const start = (currentPage - 1) * postsPerPage;
      const end = start + postsPerPage;
      const pagePosts = filtered.slice(start, end);

      if(pagePosts.length === 0){
        postsEl.innerHTML = '<div style="color:gray; text-align:center; padding:20px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©</div>';
      } else {
        pagePosts.forEach(d => {
          const post = document.createElement('div');
          post.className = 'post';
          const tags = (d.tags || '').split(',').map(tag => tag.trim()).filter(tag => tag).map(tag => `<span class="tag" onclick="filterByTag('${tag}')">${tag}</span>`).join(' ');
          post.innerHTML = `
            ${d.image ? `<img src="${d.image}" alt="${d.title}">` : ''}
            <h2>${d.title || ''}</h2>
            <div class="meta">${d.date || ''} â€” ${d.author || 'Ù…Ø¬Ù‡ÙˆÙ„'} â€” ${d.category || ''}</div>
            <p>${d.summary || ''}</p>
            <div class="tags">${tags}</div>
            <a href="#" class="read-more" onclick='openModal("${escapeQuotes(d.title)}", "${escapeQuotes(d.date)}", "${escapeQuotes(d.author)}", "${escapeQuotes(d.content)}")'>Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯</a>
          `;
          postsEl.appendChild(post);
        });
      }
      renderPagination(filtered.length);
    }

    function renderPagination(totalItems) {
      const totalPages = Math.ceil(totalItems / postsPerPage);
      const paginationEl = document.getElementById('pagination');
      paginationEl.innerHTML = '';

      if(totalPages <= 1) return;

      for(let i=1; i<=totalPages; i++) {
        const btn = document.createElement('button');
        btn.innerText = i;
        btn.className = (i === currentPage) ? 'active' : '';
        btn.onclick = () => { currentPage = i; renderPosts(); window.scrollTo({top:0, behavior:'smooth'}); };
        paginationEl.appendChild(btn);
      }
    }

    function escapeQuotes(str="") {
      return String(str).replace(/"/g, '&quot;').replace(/'/g, "&#39;");
    }

    function openModal(title, date, author, content) {
      document.getElementById('modalTitle').innerText = title;
      document.getElementById('modalMeta').innerText = `${date} â€” ${author}`;
      document.getElementById('modalContent').innerHTML = content;
      document.getElementById('modal').style.display = 'block';
    }

    function closeModal() {
      document.getElementById('modal').style.display = 'none';
    }

    function filterByTag(tag) {
      document.getElementById('searchInput').value = tag;
      currentPage = 1;
      renderPosts();
    }

    window.onclick = function(event) {
      if (event.target == document.getElementById('modal')) {
        closeModal();
      }
    }

    document.getElementById('searchInput').addEventListener('input', () => { currentPage = 1; renderPosts(); });
    document.getElementById('categoryFilter').addEventListener('change', () => { currentPage = 1; renderPosts(); });

    loadPosts();
  </script>
</body>
</html>
